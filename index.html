<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Doctor Team</title>

<style>
body {
  font-family: "Segoe UI", sans-serif;
  background: #f4f7fb;
  padding: 20px;
}

h1 {
  text-align: center;
  color: #0d6efd;
}

.card {
  background: white;
  max-width: 500px;
  margin: 20px auto;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

label {
  font-weight: bold;
  display: block;
  margin-top: 10px;
}

input {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
  border-radius: 5px;
  border: 1px solid #ccc;
}

button {
  margin-top: 15px;
  padding: 10px;
  background: #0d6efd;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

button:hover {
  background: #084298;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

th, td {
  border: 1px solid #ddd;
  padding: 10px;
}

th {
  background: #0d6efd;
  color: white;
}

.delete-btn {
  background: #dc3545;
  border: none;
  color: white;
  padding: 5px 10px;
  border-radius: 5px;
  cursor: pointer;
}

.delete-btn:hover {
  background: #a71d2a;
}

.admin-box {
  max-width: 400px;
  margin: 30px auto;
  text-align: center;
}
</style>
</head>

<body>

<h1>Doctor Team</h1>

<!-- ç”³è¯·è¡¨ -->
<div class="card">
  <h2>Apply To Join Us</h2>

  <label>Name</label>
  <input id="nameInput">

  <label>Sign</label>
  <input id="signInput">

  <label>Certificate</label>
  <input id="certInput">

  <button id="submitBtn">Submit</button>
</div>

<!-- ç®¡ç†å‘˜ç™»å½• -->
<div class="admin-box">
  <h3>Admin Login</h3>
  <input type="password" id="adminPassword" placeholder="Enter admin password">
  <button id="adminLoginBtn">Login as Admin</button>
  <p id="adminStatus"></p>
</div>

<!-- æ•°æ®è¡¨ -->
<div class="card">
  <h2>Doctor List</h2>
  <table>
    <thead>
      <tr>
        <th>Time</th>
        <th>Name</th>
        <th>Sign</th>
        <th>Certificate</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="recordsList">
      <tr><td colspan="5">Loading...</td></tr>
    </tbody>
  </table>
</div>

<!-- Firebase -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

/* ðŸ” ç®¡ç†å‘˜å¯†ç ï¼ˆä½ è‡ªå·±æ”¹ï¼‰ */
const ADMIN_PASSWORD = "bosjie12728";

/* Firebase config */
const firebaseConfig = {
  apiKey: "AIzaSyDzf_IRIDZl2_hukHAEPeLCnTcDhXuNzI4",
  authDomain: "test-c8f5b.firebaseapp.com",
  databaseURL: "https://test-c8f5b-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "test-c8f5b",
  storageBucket: "test-c8f5b.appspot.com",
  messagingSenderId: "383603417544",
  appId: "1:383603417544:web:7d351f659af0ecf046e0fd"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const doctorsRef = ref(db, "doctors");

/* ç®¡ç†å‘˜çŠ¶æ€ */
let isAdmin = false;

/* Admin login */
document.getElementById("adminLoginBtn").onclick = () => {
  const pwd = document.getElementById("adminPassword").value;
  if (pwd === ADMIN_PASSWORD) {
    isAdmin = true;
    document.getElementById("adminStatus").innerText = "âœ… Admin mode enabled";
  } else {
    alert("Wrong password");
  }
};

/* æäº¤ç”³è¯· */
document.getElementById("submitBtn").onclick = () => {
  const name = nameInput.value.trim();
  const sign = signInput.value.trim();
  const cert = certInput.value.trim();

  if (!name || !sign || !cert) {
    alert("è¯·å¡«å†™æ‰€æœ‰å­—æ®µ");
    return;
  }

  push(doctorsRef, {
    name,
    sign,
    cert,
    timestamp: Date.now()
  });

  nameInput.value = "";
  signInput.value = "";
  certInput.value = "";
};

/* å®žæ—¶æ˜¾ç¤ºæ•°æ® */
onValue(doctorsRef, snapshot => {
  recordsList.innerHTML = "";

  const data = snapshot.val();
  if (!data) {
    recordsList.innerHTML = `<tr><td colspan="5">No records</td></tr>`;
    return;
  }

  Object.entries(data)
    .sort((a, b) => b[1].timestamp - a[1].timestamp)
    .forEach(([key, item]) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${new Date(item.timestamp).toLocaleString()}</td>
        <td>${item.name}</td>
        <td>${item.sign}</td>
        <td>${item.cert}</td>
        <td>
          ${isAdmin ? `<button class="delete-btn" data-key="${key}">Delete</button>` : ""}
        </td>
      `;
      recordsList.appendChild(tr);
    });

  if (isAdmin) {
    document.querySelectorAll(".delete-btn").forEach(btn => {
      btn.onclick = () => {
        if (confirm("ç¡®å®šåˆ é™¤ï¼Ÿ")) {
          remove(ref(db, "doctors/" + btn.dataset.key));
        }
      };
    });
  }
});
</script>

</body>
</html>




